{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ahxov\\\\render-x\\\\src\\\\pages\\\\Checkout.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_51RUd79Rsx8wcTqfiztL12hlD4WJM2mtpUNSSuvuDg7U1nRbNcLj7bMbQLmJ4DhuY6ukpQWYhFzMXylqWbt8GHnAO00TyTsZHYw\"); // your Stripe key\n\nconst CheckoutForm = ({\n  cart,\n  total,\n  paymentMethod,\n  navigate\n}) => {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    // 1. Create PaymentIntent\n    const paymentRes = await fetch(\"http://localhost:5000/api/payments/create-payment\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        total\n      })\n    });\n    const paymentData = await paymentRes.json();\n    if (!paymentData.clientSecret) return alert(\"Stripe init failed\");\n\n    // 2. Confirm card payment\n    const result = await stripe.confirmCardPayment(paymentData.clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement)\n      }\n    });\n    if (result.error) {\n      alert(result.error.message);\n    } else if (result.paymentIntent.status === \"succeeded\") {\n      // 3. Save Order\n      const orderRes = await fetch(\"http://localhost:5000/api/orders\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          items: cart.map(({\n            name,\n            price\n          }) => ({\n            name,\n            price\n          })),\n          total: Number(total)\n        })\n      });\n      if (orderRes.ok) {\n        navigate(\"/success\", {\n          state: {\n            cart,\n            total,\n            paymentMethod\n          }\n        });\n      } else {\n        alert(\"Order save failed\");\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"space-y-4\",\n    children: [/*#__PURE__*/_jsxDEV(CardElement, {\n      className: \"bg-white p-4 rounded\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"w-full bg-green-500 hover:bg-green-600 py-2 rounded font-semibold text-white\",\n      disabled: !stripe || !elements,\n      children: \"Pay with Card\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n};\n_s(CheckoutForm, \"EKvoGMX7lxsZ5SGPpYu2aKFzClQ=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutForm;\nconst Checkout = () => {\n  _s2();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [paymentMethod, setPaymentMethod] = useState(\"card\");\n  const [cart, setCart] = useState([]);\n  const [total, setTotal] = useState(0);\n  useEffect(() => {\n    var _location$state, _location$state2;\n    if ((_location$state = location.state) !== null && _location$state !== void 0 && _location$state.cart && (_location$state2 = location.state) !== null && _location$state2 !== void 0 && _location$state2.total) {\n      setCart(location.state.cart);\n      setTotal(location.state.total);\n    }\n  }, [location.state]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex items-center justify-center min-h-screen bg-gray-900 p-4 text-white\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-md\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate(\"/shop\"),\n        className: \"bg-yellow-500 text-black px-4 py-2 rounded hover:bg-yellow-600 mb-4 font-semibold shadow\",\n        children: \"\\u2B05 Back to Shop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-800 p-8 rounded-lg shadow-lg\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold mb-6 text-center\",\n          children: \"Checkout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-4\",\n          children: [\"Total: AED \", total]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), paymentMethod === \"card\" && /*#__PURE__*/_jsxDEV(Elements, {\n          stripe: stripePromise,\n          children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n            cart: cart,\n            total: total,\n            paymentMethod: paymentMethod,\n            navigate: navigate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this);\n};\n_s2(Checkout, \"BSms+oPjsVW7e0XdGa6isnT4eWQ=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c2 = Checkout;\nexport default Checkout;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Checkout\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","loadStripe","Elements","CardElement","useStripe","useElements","jsxDEV","_jsxDEV","stripePromise","CheckoutForm","cart","total","paymentMethod","navigate","_s","stripe","elements","handleSubmit","e","preventDefault","paymentRes","fetch","method","headers","body","JSON","stringify","paymentData","json","clientSecret","alert","result","confirmCardPayment","payment_method","card","getElement","error","message","paymentIntent","status","orderRes","items","map","name","price","Number","ok","state","onSubmit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","disabled","_c","Checkout","_s2","location","setPaymentMethod","setCart","setTotal","_location$state","_location$state2","onClick","_c2","$RefreshReg$"],"sources":["C:/Users/ahxov/render-x/src/pages/Checkout.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport {\r\n  Elements,\r\n  CardElement,\r\n  useStripe,\r\n  useElements,\r\n} from \"@stripe/react-stripe-js\";\r\n\r\nconst stripePromise = loadStripe(\r\n  \"pk_test_51RUd79Rsx8wcTqfiztL12hlD4WJM2mtpUNSSuvuDg7U1nRbNcLj7bMbQLmJ4DhuY6ukpQWYhFzMXylqWbt8GHnAO00TyTsZHYw\"\r\n); // your Stripe key\r\n\r\nconst CheckoutForm = ({ cart, total, paymentMethod, navigate }) => {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // 1. Create PaymentIntent\r\n    const paymentRes = await fetch(\r\n      \"http://localhost:5000/api/payments/create-payment\",\r\n      {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ total }),\r\n      }\r\n    );\r\n\r\n    const paymentData = await paymentRes.json();\r\n    if (!paymentData.clientSecret) return alert(\"Stripe init failed\");\r\n\r\n    // 2. Confirm card payment\r\n    const result = await stripe.confirmCardPayment(paymentData.clientSecret, {\r\n      payment_method: {\r\n        card: elements.getElement(CardElement),\r\n      },\r\n    });\r\n\r\n    if (result.error) {\r\n      alert(result.error.message);\r\n    } else if (result.paymentIntent.status === \"succeeded\") {\r\n      // 3. Save Order\r\n      const orderRes = await fetch(\"http://localhost:5000/api/orders\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          items: cart.map(({ name, price }) => ({ name, price })),\r\n          total: Number(total),\r\n        }),\r\n      });\r\n\r\n      if (orderRes.ok) {\r\n        navigate(\"/success\", { state: { cart, total, paymentMethod } });\r\n      } else {\r\n        alert(\"Order save failed\");\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      <CardElement className=\"bg-white p-4 rounded\" />\r\n      <button\r\n        type=\"submit\"\r\n        className=\"w-full bg-green-500 hover:bg-green-600 py-2 rounded font-semibold text-white\"\r\n        disabled={!stripe || !elements}\r\n      >\r\n        Pay with Card\r\n      </button>\r\n    </form>\r\n  );\r\n};\r\n\r\nconst Checkout = () => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const [paymentMethod, setPaymentMethod] = useState(\"card\");\r\n  const [cart, setCart] = useState([]);\r\n  const [total, setTotal] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (location.state?.cart && location.state?.total) {\r\n      setCart(location.state.cart);\r\n      setTotal(location.state.total);\r\n    }\r\n  }, [location.state]);\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center min-h-screen bg-gray-900 p-4 text-white\">\r\n      <div className=\"w-full max-w-md\">\r\n        <button\r\n          onClick={() => navigate(\"/shop\")}\r\n          className=\"bg-yellow-500 text-black px-4 py-2 rounded hover:bg-yellow-600 mb-4 font-semibold shadow\"\r\n        >\r\n          â¬… Back to Shop\r\n        </button>\r\n\r\n        <div className=\"bg-gray-800 p-8 rounded-lg shadow-lg\">\r\n          <h1 className=\"text-2xl font-bold mb-6 text-center\">Checkout</h1>\r\n\r\n          <p className=\"mb-4\">Total: AED {total}</p>\r\n\r\n          {paymentMethod === \"card\" && (\r\n            <Elements stripe={stripePromise}>\r\n              <CheckoutForm\r\n                cart={cart}\r\n                total={total}\r\n                paymentMethod={paymentMethod}\r\n                navigate={navigate}\r\n              />\r\n            </Elements>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}